!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).SplitType=e()}(this,function(){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function t(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function e(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function o(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?e(Object(o),!0).forEach(function(t){var e,n;e=r,t=o[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(o,i){return Object.getOwnPropertyNames(Object(o)).reduce(function(t,e){var n=Object.getOwnPropertyDescriptor(Object(o),e),r=Object.getOwnPropertyDescriptor(Object(i),e);return Object.defineProperty(t,e,r||n)},{})}function f(t){return"string"==typeof t}function s(t){return Array.isArray(t)}function a(t){var e,n=0<arguments.length&&void 0!==t?t:{},t=p(n);return void 0!==t.types?e=t.types:void 0!==t.split&&(e=t.split),void 0!==e&&(t.types=(f(e)||s(e)?String(e):"").split(",").map(function(t){return String(t).trim()}).filter(function(t){return/((line)|(word)|(char))/i.test(t)})),(t.absolute||t.position)&&(t.absolute=t.absolute||/absolute/.test(n.position)),t}function O(t){t=f(t)||s(t)?String(t):"";return{none:!t,lines:/line/i.test(t),words:/word/i.test(t),chars:/char/i.test(t)}}function c(t){return null!==t&&"object"==typeof t}function l(t){return c(t)&&/^(1|3|11)$/.test(t.nodeType)}function j(t){return s(t)?t:null==t?[]:c(t)&&("number"==typeof(e=t.length)&&-1<e&&e%1==0)?Array.prototype.slice.call(t):[t];var e}function u(t){var e=t;return j(e=f(t)?/^(#[a-z]\w+)$/.test(t.trim())?document.getElementById(t.trim().slice(1)):document.querySelectorAll(t):e).reduce(function(t,e){return[].concat(w(t),w(j(e).filter(l)))},[])}function d(){for(var t=arguments.length,e=0;e<t;e++){var n=e<0||arguments.length<=e?void 0:arguments[e];1===n.nodeType||11===n.nodeType?this.appendChild(n):this.appendChild(document.createTextNode(String(n)))}}function h(){for(;this.lastChild;)this.removeChild(this.lastChild);arguments.length&&this.append.apply(this,arguments)}function y(){for(var t=this.parentNode,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n.length;if(t)for(o||t.removeChild(this);o--;){var i=n[o];"object"!=typeof i?i=this.ownerDocument.createTextNode(i):i.parentNode&&i.parentNode.removeChild(i),o?t.insertBefore(this.previousSibling,i):t.replaceChild(i,this)}}"undefined"!=typeof Element&&(Element.prototype.append||(Element.prototype.append=d,DocumentFragment.prototype.append=d),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=h,DocumentFragment.prototype.replaceChildren=h),Element.prototype.replaceWith||(Element.prototype.replaceWith=y,DocumentFragment.prototype.replaceWith=y));var g=Object.entries,m="_splittype",b={},C=0;function E(t,e,n){if(!c(t))return console.warn("[data.set] owner is not an object"),0;var r=t[m]||(t[m]=++C),t=b[r]||(b[r]={});return void 0===n?e&&Object.getPrototypeOf(e)===Object.prototype&&(b[r]=o(o({},t),e)):void 0!==e&&(t[e]=n),n}function S(t,e){t=c(t)?t[m]:null,t=t&&b[t]||{};return void 0===e?t:t[e]}function x(t){var e=t&&t[m];e&&(delete t[e],delete b[e])}var T="\\ud800-\\udfff",W="\\u0300-\\u036f\\ufe20-\\ufe23",k="\\u20d0-\\u20f0",A="\\ufe0e\\ufe0f",P="[".concat(T,"]"),D="[".concat(W).concat(k,"]"),N="\\ud83c[\\udffb-\\udfff]",R="(?:".concat(D,"|").concat(N,")"),$="[^".concat(T,"]"),B="(?:\\ud83c[\\udde6-\\uddff]){2}",F="[\\ud800-\\udbff][\\udc00-\\udfff]",I="".concat(R,"?"),R="[".concat(A,"]?"),I=R+I+("(?:\\u200d(?:"+[$,B,F].join("|"))+")"+R+I+")*",P="(?:".concat(["".concat($).concat(D,"?"),D,B,F,P].join("|"),"\n)"),L=RegExp("".concat(N,"(?=").concat(N,")|").concat(P).concat(I),"g"),H=RegExp("[".concat(["\\u200d",T,W,k,A].join(""),"]"));function M(t){return H.test(t)}function z(t,n){var r=document.createElement(t);return n&&Object.keys(n).forEach(function(t){var e=n[t],e=f(e)?e.trim():e;null!==e&&""!==e&&("children"===t?r.append.apply(r,w(j(e))):r.setAttribute(t,e))}),r}var V={splitClass:"",lineClass:"line",wordClass:"word",charClass:"char",types:["lines","words","chars"],absolute:!1,tagName:"div"};function q(t,s){var e,a=O((s=p(V,s)).types),c=s.tagName,n=t.nodeValue,l=document.createDocumentFragment(),u=[];return/^\s/.test(n)&&l.append(" "),e=function(t,e){e=1<arguments.length&&void 0!==e?e:" ";return(t?String(t):"").trim().replace(/\s+/g," ").split(e)}(n).reduce(function(t,e,n,r){var o,i;return a.chars&&(i=function(t,e){var n=1<arguments.length&&void 0!==e?e:"";return(t=null==(e=t)?"":String(e))&&f(t)&&!n&&M(t)?M(e=t)?e.match(L)||[]:e.split(""):t.split(n)}(e).map(function(t){t=z(c,{class:"".concat(s.splitClass," ").concat(s.charClass),style:"display: inline-block;",children:t});return E(t,"isChar",!0),u=[].concat(w(u),[t]),t})),a.words||a.lines?(E(o=z(c,{class:"".concat(s.wordClass," ").concat(s.splitClass),style:"display: inline-block; ".concat(a.words&&s.absolute?"position: relative;":""),children:a.chars?i:e}),{isWord:!0,isWordStart:!0,isWordEnd:!0}),l.appendChild(o)):i.forEach(function(t){l.appendChild(t)}),n<r.length-1&&l.append(" "),a.words?t.concat(o):t},[]),/\s$/.test(n)&&l.append(" "),t.replaceWith(l),{words:e,chars:u}}function U(i,l,u){var t,e,c,s=O(l.types),n=l.tagName,r=i.getElementsByTagName("*"),a=[],p=[],f=null,o=[],d=i.parentElement,h=i.nextElementSibling,y=document.createDocumentFragment(),g=window.getComputedStyle(i),m=g.textAlign,b=.2*parseFloat(g.fontSize);return l.absolute&&(c={left:i.offsetLeft,top:i.offsetTop,width:i.offsetWidth},e=i.offsetWidth,t=i.offsetHeight,E(i,{cssWidth:i.style.width,cssHeight:i.style.height})),j(r).forEach(function(t){var c=t.parentElement===i,e=function(t){if(!l.absolute)return{top:c?t.offsetTop:null};var e=t.offsetParent,n=v(u,2),r=n[0],o=n[1],i=0,s=0;e&&e!==document.body&&(i=(a=e.getBoundingClientRect()).x+r,s=a.y+o);var n=t.getBoundingClientRect(),e=n.width,a=n.height,t=n.x;return{width:e,height:a,top:n.y+o-s,left:t+r-i}}(t),n=e.width,r=e.height,o=e.top,e=e.left;/^br$/i.test(t.nodeName)||(s.lines&&c&&((null===f||b<=o-f)&&(f=o,a.push(p=[])),p.push(t)),l.absolute&&E(t,{top:o,left:e,width:n,height:r}))}),d&&d.removeChild(i),s.lines&&(o=a.map(function(t){var s=z(n,{class:"".concat(l.splitClass," ").concat(l.lineClass),style:"display: block; text-align: ".concat(m,"; width: 100%;")});E(s,"isLine",!0);var a={height:0,top:1e4};return y.appendChild(s),t.forEach(function(t,e,n){var r=S(t),o=r.isWordEnd,i=r.top,r=r.height,e=n[e+1];a.height=Math.max(a.height,r),a.top=Math.min(a.top,i),s.appendChild(t),o&&S(e).isWordStart&&s.append(" ")}),l.absolute&&E(s,{height:a.height,top:a.top}),s}),s.words||function t(e){S(e).isWord?(x(e),e.replaceWith.apply(e,w(e.childNodes))):j(e.children).forEach(t)}(y),i.replaceChildren(y)),l.absolute&&(i.style.width="".concat(i.style.width||e,"px"),i.style.height="".concat(t,"px"),j(r).forEach(function(t){var e=S(t),n=e.isLine,r=e.top,o=e.left,i=e.width,s=e.height,a=S(t.parentElement),e=!n&&a.isLine;t.style.top="".concat(e?r-a.top:r,"px"),t.style.left="".concat(n?c.left:o-(e?c.left:0),"px"),t.style.height="".concat(s,"px"),t.style.width="".concat(n?c.width:i,"px"),t.style.position="absolute"})),d&&(h?d.insertBefore(i,h):d.appendChild(i)),o}var X=p(V,{});return t(Y,null,[{key:"clearData",value:function(){Object.keys(b).forEach(function(t){delete b[t]})}},{key:"setDefaults",value:function(t){return X=p(X,a(t)),V}},{key:"revert",value:function(t){u(t).forEach(function(t){var e=S(t),n=e.isSplit,r=e.html,o=e.cssWidth,e=e.cssHeight;n&&(t.innerHTML=r,t.style.width=o||"",t.style.height=e||"",x(t))})}},{key:"create",value:function(t,e){return new Y(t,e)}},{key:"data",get:function(){return b}},{key:"defaults",get:function(){return X},set:function(t){X=p(X,a(t))}}]),t(Y,[{key:"split",value:function(t){var n=this;this.revert(),this.elements.forEach(function(t){E(t,"html",t.innerHTML)}),this.lines=[],this.words=[],this.chars=[];var e=[window.pageXOffset,window.pageYOffset];void 0!==t&&(this.settings=p(this.settings,a(t)));var r=O(this.settings.types);r.none||(this.elements.forEach(function(t){E(t,"isRoot",!0);var e=function r(t,o){var e=t.nodeType,n={words:[],chars:[]};if(!/(1|3|11)/.test(e))return n;if(3===e&&/\S/.test(t.nodeValue))return q(t,o);var i,s,a=j(t.childNodes);return a.length&&(E(t,"isSplit",!0),!S(t).isRoot)&&(t.style.display="inline-block",t.style.position="relative",i=t.nextSibling,s=t.previousSibling,e=t.textContent||"",i=i?i.textContent:" ",s=s?s.textContent:" ",E(t,{isWordEnd:/\s$/.test(e)||/^\s/.test(i),isWordStart:/^\s/.test(e)||/\s$/.test(s)})),a.reduce(function(t,e){var e=(n=r(e,o)).words,n=n.chars;return{words:[].concat(w(t.words),w(e)),chars:[].concat(w(t.chars),w(n))}},n)}(t,n.settings),t=e.words,e=e.chars;n.words=[].concat(w(n.words),w(t)),n.chars=[].concat(w(n.chars),w(e))}),this.elements.forEach(function(t){(r.lines||n.settings.absolute)&&(t=U(t,n.settings,e),n.lines=[].concat(w(n.lines),w(t)))}),this.isSplit=!0,window.scrollTo(e[0],e[1]),g(b).forEach(function(t){var e=v(t,2),n=e[0],t=e[1],e=t.isRoot,t=t.isSplit;e&&t||(b[n]=null,delete b[n])}))}},{key:"revert",value:function(){this.isSplit&&(this.lines=null,this.words=null,this.chars=null,this.isSplit=!1),Y.revert(this.elements)}}]),Y;function Y(t,e){!function(t){if(!(t instanceof Y))throw new TypeError("Cannot call a class as a function")}(this),this.isSplit=!1,this.settings=p(X,a(e)),this.elements=u(t),this.split()}});